<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Final Project</title>
		<script src="https://d3js.org/d3.v4.min.js"></script>

	</head>
	<body>
	<div style="width: 600px">

	  <h1>PATTERN DISCOVERY</h1>
    <h2> Click button to view animation </h2>
		<input type="radio" name="point" onclick="S()" value="1">
		<label for="1">View SO2</label>
		<input type="radio" name="point" onclick="Particles()" value="0">
		<label for="0">View Particles</label>
		<input type="radio" name="point" onclick="NO3()" value="-1">
		<label for="1">View NO3</label>


		</div>

<svg x="400" width="800" height="400" ></svg>

	<script type="text/javascript">

	SO2=[]
	var Decimal = d3.format(".2f")
	var w = 700;
	var h = 1550;
	var margin = {top: 25, right: 25, bottom: 25,
			left: 100};
	var innerWidth = w - margin.left - margin.right;
	var innerHeight = h - margin.top - margin.bottom;
	//d3.select('body').append('svg').attr("height",700).attr("width",w);
	var svg=d3.select("body").select("svg");
	svg.append("rect").attr("fill","#EEF7FA").attr("height",700).attr("width",w);

	STATE=['AL', 'AR', 'CA', 'CO', 'CT', 'FL', 'GA', 'IL', 'IN', 'KS', 'KY',
			 'MD', 'ME', 'MI', 'MS', 'NC', 'NE', 'NH', 'NJ', 'NY', 'OH', 'OK',
			 'ON', 'PA', 'TN', 'TX', 'VA', 'VT', 'WI', 'WV', 'WY']

	Month=[2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018]
// initialzation
 var color = ["#6b486b", "yellow", "red", "green","blue","darkgreen","pink","gray","purple","#FF9999","#666000", "#CC6633", "red", "green","blue","gold","pink","gray","#9966CC","yellow","#6b486b", "yellow",
 "red", "darkgray","blue","orange","pink","gray","#990033","#FF00FF"]


	var action =1;

	function S(){
					  action = 1;
						svg.selectAll("g").remove();
						var data=[[3.6048773584905667,
					  2.0136288461538463,
					  2.114296153846154,
					  1.7979489795918366,
					  1.1063961538461535,
					  0.9232615384615386,
					  1.122948,
					  0.8215274509803923,
					  0.7302372549019608,
					  0.6130673076923077,
					  0.4560735294117647],
					 [0.6301075471698114,
					  0.5358205882352942,
					  0.5858673076923077,
					  0.5225764705882355,
					  0.5085192307692308,
					  0.4949574257425743,
					  0.4801069306930694,
					  0.4656854166666667,
					  0.4078451923076922,
					  0.4430543689320387,
					  0.3110867647058825],
					 [0.3208365384615384,
					  0.24393653846153845,
					  0.2114428571428572,
					  0.6287285714285714,
					  0.4134588235294119,
					  0.42436774193548404,
					  0,
					  0,
					  0,
					  0,
					  0],
					 [0.22254102564102565,
					  0.1773435064935065,
					  0.1954019607843137,
					  0.1623045454545454,
					  0.17759407894736845,
					  0.16181133333333336,
					  0.16181381578947365,
					  0.22229597315436248,
					  0.2039709677419356,
					  0.1883660256410257,
					  0.12378921568627453],
					 [1.6817352380952382,
					  1.314225,
					  0.8747815533980586,
					  1.007069387755102,
					  0.7406153846153842,
					  0.6658316831683166,
					  0.7423865384615383,
					  0.7018494949494953,
					  0.554488349514563,
					  0.5166201923076923,
					  0.3608848484848485],
					 [0.9585490196078428,
					  0.8159106796116509,
					  0.8600060301507535,
					  0.6463534313725492,
					  0.5725673267326732,
					  0.6179465000000001,
					  0.6127470588235295,
					  0.6028135265700484,
					  0.5569633663366335,
					  0.6147584158415837,
					  0.4725198473282442],
					 [1.647719767441861,
					  0.8520952941176476,
					  0.9231152610441766,
					  0.7385987447698746,
					  0.4853352459016392,
					  0.442916796875,
					  0.458051171875,
					  0.3849201612903224,
					  0.36080625000000016,
					  0.3260064000000001,
					  0.2267668789808919],
					 [3.2774415584415584,
					  2.3405572368421046,
					  2.440346794871795,
					  2.124957792207792,
					  1.7493941176470589,
					  1.6346740506329112,
					  1.6484454545454552,
					  1.2891899999999996,
					  0.9166718954248364,
					  0.8468682432432431,
					  0.6995478723404253],
					 [3.565013513513514,
					  2.707643421052631,
					  2.7924274509803926,
					  2.359813548387097,
					  1.8107967320261449,
					  1.6927503184713382,
					  1.9121414473684213,
					  1.4119095238095238,
					  0.9393209150326796,
					  0.8911153333333338,
					  0.7573169999999998],
					 [0.6575611650485437,
					  0.5173548076923079,
					  0.45439807692307704,
					  0.43672105263157895,
					  0.40396595744680863,
					  0.3855215686274511,
					  0.3846592233009709,
					  0.3985126213592232,
					  0.3833272727272728,
					  0.3768126213592233,0.3222703125],[2.9735458745874594,
					  2.1504670033670035,
					  2.539564846416382,
					  1.784862798634813,
					  1.3488990228013018,
					  1.23585544871795,
					  1.3893737864077669,
					  0.954430103806228,
					  0.6836643790849674,
					  0.6059400651465802,
					  0.4586969072164946],
					 [5.909471568627451,
					  3.982988659793815,
					  2.88418494623656,
					  2.220013684210526,
					  1.660884210526316,
					  1.6118744444444448,
					  1.8959616161616164,
					  1.4697393939393948,
					  1.029782291666667,
					  0.9127968421052632,
					  0.8144131147540985],
					 [0.7278806896551722,
					  0.5908914473684209,
					  0.4716389261744965,
					  0.5294519774011299,
					  0.4467453125000001,
					  0.5595181395348836,
					  0.5921675257731959,
					  0.6435596685082868,
					  0.6180882051282048,
					  0.7980642857142856,
					  0.8562931297709925],
					 [2.9042342465753417,
					  1.961159712230216,
					  1.7370141891891893,
					  1.6464870129870135,
					  1.433081410256411,
					  1.3945134615384611,
					  1.3283222222222215,
					  1.198911920529801,
					  0.8359165517241386,
					  0.6760222972972973,
					  0.6137777777777778],
					 [1.4987309523809524,
					  0.9315469387755098,
					  1.2430192307692307,
					  0.882856,
					  0.810448076923077,
					  0.7174547169811321,
					  0.7947196078431372,
					  0.7914882352941174,
					  0.6534823529411764,
					  0.5718176470588237,
					  0.41555],
					 [1.863820289855072,
					  1.1571945273631845,
					  1.301683414634146,
					  0.8820401960784313,
					  0.5979980952380953,
					  0.553370038910506,
					  0.5817466135458168,
					  0.5129007812499999,
					  0.4734567460317459,
					  0.4528566265060243,
					  0.3290370370370373],
					 [1.7121534246575338,
					  1.239466025641026,
					  1.1897045454545454,
					  0.9539516339869286,
					  0.8064192546583847,
					  0.7120041025641023,
					  0.7101770408163266,
					  0.6774178217821778,
					  0.5694913461538464,
					  0.5633103448275864,
					  0.5436597014925374],
					 [0.6139753246753249,
					  0.5285506410256409,
					  0.4972739726027399,
					  0.4135355704697984,
					  0.44349161290322586,
					  0.4578412903225806,
					  0.4948793548387093,
					  0.5927000000000003,
					  0.4599273972602741,
					  0.4655751677852351,
					  0.43997755102040825],
					 [5.0138924528301905,
					  3.51358431372549,
					  2.8229019607843133,
					  2.2433469387755105,
					  1.385366,
					  1.437709433962264,
					  1.6883403846153848,
					  1.2322403846153844,
					  0.8663673076923075,
					  0.7190403846153848,
					  0.6239941176470589],
					 [1.9912162561576356,
					  1.3521965174129338,
					  1.0501348039215683,
					  1.0697390625000005,
					  0.6878221153846152,
					  0.6469240000000002,
					  0.7074719471947193,
					  0.6736417763157895,
					  0.4562647887323942,
					  0.3863163204747776,
					  0.2964169642857141],
					 [5.488574516129029,
					  3.944791909385114,
					  3.938187755102041,
					  3.4550099206349234,
					  2.4503996153846157,
					  2.2438840466926067,
					  2.050016501650164,
					  1.2396712643678156,
					  0.7924469387755092,
					  0.6899896640826866,
					  0.5620557195571956],
					 [1.2785452830188675,
					  1.048718367346939,
					  1.2002529411764706,
					  1.13005,
					  1.0517200000000002,
					  0.8777173076923077,
					  0.8082903846153846,
					  0.6931173076923075,
					  0.7165173076923076,
					  0.7108076923076923,
					  0.476335294117647],[2.404667924528302,
					  1.5319999999999996,
					  1.1993612244897958,
					  1.4309235294117646,
					  1.2729058823529418,
					  1.1236346153846153,
					  1.1773384615384612,
					  1.3267596153846155,
					  1.0770000000000002,
					  0.7623078431372547,
					  0.6592454545454546],
					 [6.512727090301003,
					  3.959734313725489,
					  3.3142660066006613,
					  2.569197350993377,
					  1.7891943573667717,
					  1.784130120481927,
					  1.9456335384615369,
					  1.4946297297297295,
					  0.9280724431818184,
					  0.7971206060606054,
					  0.6297416289592758],
					 [1.9752929936305736,
					  1.1812565789473686,
					  1.3169032258064512,
					  0.9810629870129866,
					  0.6928490066225165,
					  0.6559050847457629,
					  0.6683389743589746,
					  0.5473605128205129,
					  0.4889985148514852,
					  0.4569647368421049,
					  0.3320774193548388],
					 [1.2715563106796115,
					  1.049476923076923,
					  1.1579000000000002,
					  0.9954879518072286,
					  0.8536999999999998,
					  0.8864427184466025,
					  0.7756795918367348,
					  0.8106622448979592,
					  0.7386142857142854,
					  0.7348339999999998,
					  0.6456462686567164],
					 [2.549934928229664,
					  1.7791985436893205,
					  2.060408542713568,
					  1.6165868686868683,
					  1.3476926829268294,
					  1.241539805825243,
					  1.3506019900497512,
					  0.9533991111111114,
					  0.8141877828054297,
					  0.6172734597156401,
					  0.34650606060606065],[0.6189,0.5250434782608695,0.6005234042553189,0.5991115384615384,0.3926446808510637,
					  0.3547414634146342,
					  0.3127519999999999,
					  0,
					  0,
					  0,
					  0],
					 [1.288690566037736,
					  0.9503470588235292,
					  0.8353903846153845,
					  0.7451577777777776,
					  0.5675108108108109,
					  0.6424528301886794,
					  0.5727294117647058,
					  0.5713307692307692,
					  0.4577749999999997,
					  0.4711403846153847,
					  0.3779264705882352],
					 [3.621703883495144,
					  2.619971000000001,
					  2.73509504950495,
					  1.745815151515151,
					  1.067021212121212,
					  1.1243605769230771,
					  1.384122115384615,
					  1.0033079999999996,
					  0.6438069306930689,
					  0.6202316831683169,
					  0.4576779411764706],
					 [0.2632989898989899,
					  0.21729100000000007,
					  0.22363823529411772,
					  0.1845602040816325,
					  0.19407415730337074,
					  0.1883330097087379,
					  0.1873126213592233,
					  0.255825,
					  0.23577010309278346,
					  0.2164959999999999,
					  0.14735454545454552]]



					 var xScale = d3.scaleLinear()
					 	      .domain([0, 8])  // CHANGE
					 	      .range([0, innerWidth]);

									var yScale = d3.scaleBand()
			 											.domain(d3.range(31))
			 											.range([margin.top, innerHeight])
			 											.paddingInner(.5);

			 											var databind=[];
			 											var data_first=[];

			 											var data_first=data.map(d=>d[0]);
			 											//console.log(data_first);
			 											for (j=0;j<data_first.length;j++){

			 											databind.push({key:STATE[j],value:data_first[j]});}

			 											svg.append("g").selectAll("rect")
			 														 .data(databind)
			 														 .enter()
			 														 .append("rect").attr("x",margin.left).attr("width",function(d){return xScale(d.value)}).attr("fill",function(d,i){return color[i]}
			 										).attr("height", yScale.bandwidth()).attr("y",function(d){
			 										for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
			 											t=data_first.length-m-1;
			 											if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)}
			 											return t;}}});

			 										svg.select("g").selectAll("text")
			 													 .data(databind)
			 													 .enter()
			 													 .append("text").attr("x",50).text(d=>d.key).attr("y",function(d){
			 													 for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
			 														 t=data_first.length-m-1;
			 														if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)+yScale.bandwidth()/2}
			 														return t;}}}).attr("font-size","20px");


			 										svg.append("g").attr("id","label").selectAll("text")
			 																	.data(databind)
			 																	.enter()
			 																	.append("text").attr("x",function(d){return xScale(d.value)+130}).text(d=>Decimal(d.value)).attr("y",function(d){
			 																 for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
			 																	 t=data_first.length-m-1;
			 																	if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)+yScale.bandwidth()/2}
			 																	return t;}}}).attr("font-size","20px");

			 										svg.append("g").append("text").attr("id","Time").attr("x",500).text("Year"+" "+Month[0]).attr("y",380).attr("font-size","40px")

			 											for (i=1;i<Month.length;i++){
			 												databind=[];
			 												data_now=data.map(d=>d[i]);
			 												// binding new data
			 												for (j=0;j<data_first.length;j++){
			 												databind.push({key:STATE[j],value:data_now[j]});}

			 											//svg.select("g").selectAll('rect').data(databind).sort(function(a, b) {});
			 											svg.select("g").selectAll('rect').data(databind).transition().delay(1000*i).duration(800)
			 											.attr("width",function(d){return xScale(d.value)}).attr("y",function(d){
			 											for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
			 												t=data_now.length-m-1;
			 												if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)}
			 												return t;}}});

			 										svg.select("g").selectAll('text').data(databind).transition().delay(1000*i).duration(800).attr("y",function(d){
			 										for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
			 											t=data_now.length-m-1;
			 											if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)+yScale.bandwidth()/2}
			 											return t;}}});

			 										svg.select("g#label").selectAll('text').data(databind).transition().delay(1000*i).duration(800)
			 										.attr("x",function(d){return xScale(d.value)+130}).text(d=>Decimal(d.value)).attr("y",function(d){
			 										for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
			 											t=data_now.length-m-1;
			 											if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)+yScale.bandwidth()/2}
			 											return t;}}});
			 										svg.select("#Time").transition().delay(1100*i).duration(800)
			 										.text("Year"+" "+Month[i])
			 										}


}

	function Particles(){
		action=0;
		svg.selectAll("g").remove();
		var data=[[0.52696875,
  0.4850304166666667,
  0.53384125,
  0.5779573610000001,
  0.5718841666666666,
  0.4594475,
  0.5095281945,
  0.4925804166666667,
  0.5640304166666666,
  0.5389120833333333,
  0.5231083332500001],
 [0.4799325,
  0.4295239582500001,
  0.4384614583333333,
  0.4958554629166667,
  0.5202437038333335,
  0.4273384624166667,
  0.443277381,
  0.4119613030000001,
  0.3977883928333334,
  0.428300701,
  0.4987902083749999],
 [0.5240229166666666,
  0.4911229166666666,
  0.4152613888333333,
  0.281495,
  0.2690830555000001,
  0.31512833337499996,
  0,
  0,
  0,
  0,
  0],
 [0.19871871175,
  0.1899410363333333,
  0.18978470608333334,
  0.16043247508333333,
  0.2311219530833333,
  0.16947843249999994,
  0.1702730335,
  0.1457622220833333,
  0.14846791666666667,
  0.15609646824999998,
  0.237715416625],
 [0.4858749536666666,
  0.4925441666666666,
  0.4598695536666666,
  0.5095727910833335,
  0.4766997917499999,
  0.47360183200000006,
  0.5659325,
  0.4895346196666666,
  0.505768125,
  0.4943785416666666,
  0.4722949205],
 [1.56407553675,
  1.3382016659166664,
  1.3289381934166664,
  1.4106469263333334,
  1.4750863811666666,
  1.4829419097499998,
  1.2389856213333332,
  1.3607165113333333,
  1.3725892467499998,
  1.392663427833333,
  1.3883592427500002],
 [0.4310782446666667,
  0.3722322863333333,
  0.33716504525,
  0.3541580985833333,
  0.36833807416666653,
  0.32500337516666666,
  0.3393243150833334,
  0.34724276533333337,
  0.3488193015833333,
  0.3631650099166666,
  0.4186887372500001],
 [0.7703349008333333,
  0.7264186492500001,
  0.8905877975833332,
  0.8436241542499999,
  0.9282784273333334,
  0.8276069190833333,
  0.8385899114999998,
  0.7885456835833334,
  0.7383101788333333,
  0.8942369345000001,
  0.720403750125],
 [0.70036568925,
  0.6684209723333335,
  0.8038345113333332,
  0.6819844045833334,
  0.7717494425833334,
  0.6464158728333333,
  0.6343464151666668,
  0.649826098,
  0.6281344065833331,
  0.7305532047500001,
  0.6580881808750001],
 [0.8613966204166666,
  0.8513237500000003,
  0.9012364880833332,
  0.8521079167500001,
  1.0833377380833331,
  0.8873240906666667,
  0.98084256925,
  0.9239833035833334,
  0.9894955026666666,
  1.041555119,
  1.11426016375],
 [0.44884144733333337,
  0.4429502881666667,
  0.4750027986666666,
  0.4481737320833333,
  0.48205681175,
  0.40692580975000003,
  0.4409857664166668,
  0.39999058466666665,
  0.3941173808333333,
  0.44558805575,
  0.4252289890000001],
 [0.6490052183333334,
  0.5912704895833334,
  0.5788839054166667,
  0.5829116139166667,
  0.5160336904999999,
  0.5747516929999998,
  0.6086621328333334,
  0.6379259025,
  0.5285408760833333,
  0.5544058002500001,
  0.6085909227499999],
 [0.5276621930000001,
  0.4316755399166667,
  0.3819654273333333,
  0.5588365135,
  0.3673304209166666,
  0.37447044674999996,
  0.4255780378333333,
  0.3622904790833333,
  0.3493342816666667,
  0.3845517546666668,
  0.45546459475],
 [0.4660691095,
  0.48219584325,
  0.4933413888333334,
  0.43063578816666653,
  0.4949969116666666,
  0.4224977808333334,
  0.4278857319166667,
  0.4627795235833334,
  0.4373486330833334,
  0.4402620084166667,
  0.4689337688750001],
 [0.5537688889166668,
  0.4732091666666666,
  0.5639533333333334,
  0.5611494444166667,
  0.5373644444166668,
  0.4307579166666667,
  0.50857,
  0.5204706944999999,
  0.4961541666666667,
  0.5412030554999999,
  0.531742500125],
 [0.7114112054999999,
  0.6467226426666668,
  0.5987139911666667,
  0.6478282451666667,
  0.54712515975,
  0.5010563725833334,
  0.4541135997499999,
  0.49739689025,
  0.4799325285833333,
  0.5037227970000001,
  0.540968619875],
 [0.519401049,
  0.4849411111666666,
  0.4879141919166667,
  0.4747583980833334,
  0.5706077315,
  0.43990996541666666,
  0.43417795216666666,
  0.4472161353333333,
  0.4378164583333333,
  0.4675683396666666,
  0.478796346],
 [0.21198490700000006,
  0.19776611116666676,
  0.20171879066666668,
  0.19721596874999994,
  0.22314156850000003,
  0.21044045175,
  0.2198881565,
  0.21703912774999998,
  0.1931417225,
  0.22358711766666664,
  0.35730550575000003],
 [0.5483129166666668,
  0.5895941666666668,
  0.54862041675,
  0.5503120833333334,
  0.5131986110833332,
  0.5579254166666666,
  0.5920975000000002,
  0.62242,
  0.5199562499999999,
  0.5354333333333333,
  0.572683541625],
 [0.2708630361666667,
  0.2789653057500001,
  0.2812714308333333,
  0.2486552013333333,
  0.2790738535,
  0.2464200483333333,
  0.2565793685,
  0.27440912091666664,
  0.2335116935833333,
  0.2388563890833333,
  0.265739873125],
 [0.4914211066666667,
  0.4772779560833333,
  0.5591215194999999,
  0.4293009239999999,
  0.4521939110833332,
  0.4262472259166667,
  0.4542261895833333,
  0.4302010626666665,
  0.3808149055833333,
  0.4328410668333333,
  0.43556556112499994],
 [0.6704641666666666,
  0.6739505554999999,
  0.7279458333333334,
  0.8039577778333334,
  0.8311245833333335,
  0.63401527775,
  0.7299870833333334,
  0.6375795833333334,
  0.7060066666666667,
  0.7199120833333333,
  0.747170416625],
 [0.58180875,
  0.5560227778333334,
  0.57466361125,
  0.5591169444166667,
  0.5527345833333334,
  0.55735708325,
  0.6091724999999999,
  0.6606145833333333,
  0.6441866666666668,
  0.5926887500000001,
  0.5855918752500001],
 [0.3835483901666666,
  0.36314972358333336,
  0.3911886665833333,
  0.3444383736666667,
  0.35332367699999995,
  0.3952352418333333,
  0.6107628483333333,
  0.6242729612500001,
  0.5874196308333334,
  0.6607827223333332,
  0.6079008433749999],
 [1.1307523340833334,
  0.9324583258333332,
  1.0343430419166666,
  0.98747531575,
  1.0858264102500002,
  1.1657866918333333,
  0.7959276552500001,
  0.7390387878333332,
  0.8907367195,
  0.7642372917500001,
  0.906734582375],
 [1.0699405918333336,
  0.9278762795833332,
  0.9527366236666668,
  1.2888913690000001,
  1.0986732175833331,
  0.9825634093333334,
  1.026534213,
  0.8688538990000001,
  0.8811272950000002,
  0.9915760153333334,
  1.172971994],
 [0.5261741204166666,
  0.49087090275,
  0.47687202925,
  0.4840904948333333,
  0.5082059949999999,
  0.4632331985833333,
  0.5058393996666668,
  0.4291280440833333,
  0.45121733399999997,
  0.4847354344166666,
  0.5573493456249999],
 [0.199416667,
  0.29005638899999997,
  0.26607777774999997,
  0.2761091666666667,
  0.24301027766666666,
  0.2568115278333333,
  0.284578124875,
  0,
  0,
  0,
  0],
 [0.39403666666666665,
  0.38824083333333337,
  0.44833541666666665,
  0.4037072727272728,
  0.4920086666,
  0.4208158333333333,
  0.36033916666666665,
  0.4626966666666666,
  0.3489204166666667,
  0.4330320833333334,
  0.46450916675],
 [0.4726879761666667,
  0.5029310714166666,
  0.5800014583333334,
  0.45652071125,
  0.42961918975,
  0.39730418633333336,
  0.4365455357500001,
  0.4669098511666666,
  0.415124375,
  0.39558138891666667,
  0.4008878125000001],
 [0.17081063500000002,
  0.17582604166666665,
  0.15995425933333332,
  0.14247432191666662,
  0.2480281745833333,
  0.16754942775,
  0.15253586300000002,
  0.15004512241666665,
  0.20329022475000005,
  0.14493286033333336,
  0.20857266875]]

	 var xScale = d3.scaleLinear()
					.domain([0, 3])  // CHANGE
					.range([0, innerWidth]);

	 var yScale = d3.scaleBand()
							.domain(d3.range(31))
							.range([margin.top, innerHeight])
							.paddingInner(.5);

							var databind=[];
							var data_first=[];

							var data_first=data.map(d=>d[0]);
							//console.log(data_first);
							for (j=0;j<data_first.length;j++){

							databind.push({key:STATE[j],value:data_first[j]});}

							svg.append("g").selectAll("rect")
										 .data(databind)
										 .enter()
										 .append("rect").attr("x",margin.left).attr("width",function(d){return xScale(d.value)}).attr("fill",function(d,i){return color[i]}
						).attr("height", yScale.bandwidth()).attr("y",function(d){
						for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
							t=data_first.length-m-1;
							if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)}
							return t;}}});

						svg.select("g").selectAll("text")
									 .data(databind)
									 .enter()
									 .append("text").attr("x",50).text(d=>d.key).attr("y",function(d){
									 for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
										 t=data_first.length-m-1;
										if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)+yScale.bandwidth()/2}
										return t;}}}).attr("font-size","20px");


						svg.append("g").attr("id","label").selectAll("text")
													.data(databind)
													.enter()
													.append("text").attr("x",function(d){return xScale(d.value)+130}).text(d=>Decimal(d.value)).attr("y",function(d){
												 for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
													 t=data_first.length-m-1;
													if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)+yScale.bandwidth()/2}
													return t;}}}).attr("font-size","20px");

						svg.append("g").append("text").attr("id","Time").attr("x",500).text("Year"+" "+Month[0]).attr("y",380).attr("font-size","40px")

							for (i=1;i<Month.length;i++){
								databind=[];
								data_now=data.map(d=>d[i]);
								// binding new data
								for (j=0;j<data_first.length;j++){
								databind.push({key:STATE[j],value:data_now[j]});}

							//svg.select("g").selectAll('rect').data(databind).sort(function(a, b) {});
							svg.select("g").selectAll('rect').data(databind).transition().delay(1000*i).duration(800)
							.attr("width",function(d){return xScale(d.value)}).attr("y",function(d){
							for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
								t=data_now.length-m-1;
								if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)}
								return t;}}});

						svg.select("g").selectAll('text').data(databind).transition().delay(1000*i).duration(800).attr("y",function(d){
						for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
							t=data_now.length-m-1;
							if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)+yScale.bandwidth()/2}
							return t;}}});

						svg.select("g#label").selectAll('text').data(databind).transition().delay(1000*i).duration(800)
						.attr("x",function(d){return xScale(d.value)+130}).text(d=>Decimal(d.value)).attr("y",function(d){
						for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
							t=data_now.length-m-1;
							if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)+yScale.bandwidth()/2}
							return t;}}});
						svg.select("#Time").transition().delay(1100*i).duration(800)
						.text("Year"+" "+Month[i])
						}








	}

	function NO3(){
 	 action=-1;
	 svg.selectAll("g").remove();
	 var data=[[2.4322858333333337,
  1.9859729166666664,
  2.225947083333333,
  2.0136625,
  1.83876,
  1.7137054166666663,
  1.7245320833333333,
  1.6662904166666666,
  1.6394329166666666,
  1.5043045833333333,
  1.47607625],
 [1.2159464583333337,
  1.06660877975,
  1.12058375,
  1.1855417295,
  1.1189068584166668,
  1.0764287400833334,
  0.9093054298333332,
  0.9043348181666668,
  0.8330537499999999,
  0.80796573075,
  0.9047915625],
 [3.0777225,
  2.7166249999999987,
  2.297428333333334,
  0.774595,
  0.7526994444166667,
  0.8706408333750001,
  0,
  0,
  0,
  0,
  0],
 [0.5448986385833333,
  0.4717348503333333,
  0.4891314285833333,
  0.4270742171666666,
  0.5007180225,
  0.4545914610833333,
  0.4128073016666667,
  0.4243256944166667,
  0.38528306841666665,
  0.39791430558333335,
  0.518338263875],
 [1.3393716203333332,
  1.2382245833333332,
  1.0551510648333335,
  1.2449009722500002,
  1.21361682875,
  1.0950345270833333,
  1.1406447916666664,
  1.0962738922500002,
  1.0115600595,
  0.9781568749999998,
  1.00756209325],
 [1.7949906803333333,
  1.5699281505833336,
  1.6613944013333335,
  1.4442194825,
  1.4641784312499997,
  1.3942618366666666,
  1.4331109495833336,
  1.3172361129166668,
  1.2771060479166667,
  1.3099551720833331,
  1.4884503375000002],
 [1.0992897294166666,
  0.89110606175,
  0.9713822547499998,
  0.8589121229166667,
  0.8570719045833334,
  0.78959994675,
  0.7990548838333332,
  0.7770106695000001,
  0.7635948998333334,
  0.7784870400833334,
  0.7431894824999999],
 [3.4265694444166663,
  3.145481868833334,
  3.509913472083334,
  3.176046224583333,
  3.0813933170833328,
  2.8295160100833336,
  3.0002257954166667,
  2.463334837,
  2.43005194425,
  2.25752957725,
  2.540067569500001],
 [2.7090231005833334,
  2.501631944416667,
  2.8361443530000003,
  2.4296529167500003,
  2.491217009333333,
  2.141223376,
  2.3022990276666673,
  1.898045998666667,
  1.834463131333333,
  1.785781965333333,
  1.884542599125],
 [1.5060714119999998,
  1.3578245833333331,
  1.5126020833333331,
  1.3522096064166664,
  1.2135294940833332,
  1.28666733475,
  1.2702754397500002,
  1.1142814880833332,
  1.0197918485,
  1.0734369047499999,
  1.3674190922499998],
 [1.9000779066666664,
  1.652749751,
  1.88035022075,
  1.6993075507499995,
  1.642322192,
  1.4909524091666668,
  1.5565785788333335,
  1.3821759184166666,
  1.3068543465,
  1.2842471589166666,
  1.284400892125],
 [2.621592242083334,
  2.0774582175833336,
  2.3307947983333333,
  2.157960324083333,
  2.1384781845000003,
  1.9394535649166669,
  2.018780863166667,
  1.9168923908333335,
  1.7748716799166668,
  1.6540369874166665,
  1.767389628],
 [0.7276885336666666,
  0.6622708547499999,
  0.5370188927499999,
  0.7131541434166667,
  0.5937571664166666,
  0.6744935760833334,
  0.6877120913333333,
  0.6520611606666668,
  0.6082767964166668,
  0.6537935398333334,
  0.7203488131250001],
 [2.4337204708333338,
  2.2483534342500002,
  1.9842112500833329,
  2.154167904,
  2.2332740938333338,
  1.8596052700833332,
  2.0561341541666667,
  1.9692476171666664,
  1.7693153810833333,
  1.6512273436666671,
  1.7249266260000002],
 [1.5279873610833334,
  1.2294062499999998,
  1.4316320833333334,
  1.3563268055833335,
  1.2350016666666666,
  1.0937004166666666,
  1.16559222225,
  1.0976022222499997,
  1.070155,
  0.995605,
  1.05884333325],
 [1.4387661622499996,
  1.1092607799999998,
  1.2180890844166667,
  1.193759011,
  1.0283843134166666,
  0.9287974405833332,
  0.9260003355833334,
  0.8949318383333332,
  0.8815779206666666,
  0.8634220901666665,
  0.8544887846250001],
 [2.5331685901666665,
  2.06074347225,
  2.10662007575,
  2.1191465530833336,
  2.083172218,
  1.8805801505,
  1.7751876375,
  1.6311626355000002,
  1.3994947916666665,
  1.4722875668333335,
  1.6210289421250001],
 [0.6373669214999999,
  0.5461020833333333,
  0.4655055555833334,
  0.560547841,
  0.5813250515,
  0.5659098370000001,
  0.5370064269166667,
  0.5705279079166666,
  0.44271812391666665,
  0.5063753714166668,
  0.69974752775],
 [2.7760766666666665,
  2.3613279166666667,
  2.294340833333333,
  2.37661472225,
  2.4020797222499994,
  2.287089583333333,
  2.31414,
  2.2992516666666667,
  2.1260345833333334,
  2.0076275000000003,
  1.9636591666250005],
 [1.2690526165,
  1.062851657083333,
  1.0113742434166666,
  1.0580409240833335,
  1.0173134863333335,
  0.8764472827500001,
  0.9376603115833332,
  0.9075677338333332,
  0.7322978805833333,
  0.7428988042499999,
  0.777574636375],
 [2.5493830139166658,
  2.2922316866666668,
  2.652205022,
  2.0626850456666666,
  1.9629896089166663,
  1.8578534269166669,
  1.8398388989166667,
  1.5553850786666663,
  1.4153670017500002,
  1.3995954418333334,
  1.336506049625],
 [2.1949308333333333,
  1.9401736110833327,
  2.1103870833333334,
  2.3790637500000003,
  2.1009505555000003,
  1.8859405555833335,
  1.7125658333333336,
  1.4867441666666668,
  1.53523625,
  1.46712125,
  1.6711831249999998],
 [2.4903991666666667,
  2.0090223610833333,
  1.8927270833333327,
  2.294009861083333,
  2.141366805583333,
  1.815090833333333,
  2.1551158333333333,
  2.0539025,
  1.8399025000000002,
  1.6870495833333334,
  1.775893125],
 [2.038625284,
  1.60920557875,
  1.6838368068333331,
  1.6964629142499998,
  1.6315810591666666,
  1.5828020382500003,
  1.7641439540000001,
  1.6223384240000005,
  1.4893253476666668,
  1.4893299705833334,
  1.4405036283749997],
 [1.5982466505000001,
  1.31094203375,
  1.4803348015833333,
  1.342391515,
  1.2734329070833332,
  1.1865104159166664,
  1.1151850310833331,
  1.014038752,
  1.0425329298333337,
  1.01374197925,
  1.059975161125],
 [1.6758089186666671,
  1.5265604464166669,
  1.5616343255,
  1.7874535548333332,
  1.5503828935,
  1.5327733234166665,
  1.3725557639166668,
  1.3315145668333332,
  1.17918782075,
  1.2487486011666666,
  1.3988127380000002],
 [1.6023541203333334,
  1.26785125,
  1.323915979833333,
  1.31099751325,
  1.2961744105833333,
  1.2026770895,
  1.1952494940833334,
  1.0768967373333334,
  0.96867665525,
  1.0039641475833334,
  0.9896804417499999],
 [1.0324833334999999,
  0.8138537499166668,
  0.8637370833333334,
  0.8567724999999999,
  0.6559844444999999,
  0.7317876389166665,
  0.8457360416250002,
  0,
  0,
  0,
  0],
 [2.2055804166666664,
  2.036394583333333,
  1.5627133333333336,
  1.6549831818181815,
  1.3980361666,
  1.64342125,
  1.6369804166666668,
  1.44934,
  1.417870416666667,
  1.3496687499999995,
  1.4848920833750001],
 [1.2571651190833335,
  1.0062984524166667,
  1.2313835416666667,
  0.9979567625833332,
  0.8956711177500001,
  0.9162093253333334,
  0.9949708333333334,
  0.9107969941666668,
  0.8387879166666666,
  0.8690092824166666,
  0.7913616666250001],
 [0.45918602175,
  0.3789404166666667,
  0.3973550000000001,
  0.37863740075,
  0.455050711,
  0.4013394378333333,
  0.3520314583333333,
  0.3505736475000001,
  0.3214584291666666,
  0.3408857903333333,
  0.408801885]]

  var xScale = d3.scaleLinear()
 				.domain([0, 5])  // CHANGE
 				.range([0, innerWidth]);

  var yScale = d3.scaleBand()
 						.domain(d3.range(31))
 						.range([margin.top, innerHeight])
 						.paddingInner(.5);

 						var databind=[];
 						var data_first=[];

 						var data_first=data.map(d=>d[0]);
 						//console.log(data_first);
 						for (j=0;j<data_first.length;j++){

 						databind.push({key:STATE[j],value:data_first[j]});}

 						svg.append("g").selectAll("rect")
 									 .data(databind)
 									 .enter()
 									 .append("rect").attr("x",margin.left).attr("width",function(d){return xScale(d.value)}).attr("fill",function(d,i){return color[i]}
 					).attr("height", yScale.bandwidth()).attr("y",function(d){
 					for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
 						t=data_first.length-m-1;
 						if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)}
 						return t;}}});

 					svg.select("g").selectAll("text")
 								 .data(databind)
 								 .enter()
 								 .append("text").attr("x",50).text(d=>d.key).attr("y",function(d){
 								 for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
 									 t=data_first.length-m-1;
 									if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)+yScale.bandwidth()/2}
 									return t;}}}).attr("font-size","20px");


 					svg.append("g").attr("id","label").selectAll("text")
 												.data(databind)
 												.enter()
 												.append("text").attr("x",function(d){return xScale(d.value)+130}).text(d=>Decimal(d.value)).attr("y",function(d){
 											 for(m=0;m<data_first.length;m++){if(data_first.sort()[m]==d.value){
 												 t=data_first.length-m-1;
 												if(t>10) {t=h+100} else{t=yScale(data_first.length-m-1)+yScale.bandwidth()/2}
 												return t;}}}).attr("font-size","20px");

 					svg.append("g").append("text").attr("id","Time").attr("x",500).text("Year"+" "+Month[0]).attr("y",380).attr("font-size","40px")

 						for (i=1;i<Month.length;i++){
 							databind=[];
 							data_now=data.map(d=>d[i]);
 							// binding new data
 							for (j=0;j<data_first.length;j++){
 							databind.push({key:STATE[j],value:data_now[j]});}

 						//svg.select("g").selectAll('rect').data(databind).sort(function(a, b) {});
 						svg.select("g").selectAll('rect').data(databind).transition().delay(1000*i).duration(800)
 						.attr("width",function(d){return xScale(d.value)}).attr("y",function(d){
 						for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
 							t=data_now.length-m-1;
 							if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)}
 							return t;}}});

 					svg.select("g").selectAll('text').data(databind).transition().delay(1000*i).duration(800).attr("y",function(d){
 					for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
 						t=data_now.length-m-1;
 						if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)+yScale.bandwidth()/2}
 						return t;}}});

 					svg.select("g#label").selectAll('text').data(databind).transition().delay(1000*i).duration(800)
 					.attr("x",function(d){return xScale(d.value)+130}).text(d=>Decimal(d.value)).attr("y",function(d){
 					for(m=0;m<data_now.length;m++){if(data_now.sort()[m]==d.value){
 						t=data_now.length-m-1;
 						if(t>10) {t=h+100} else{t=yScale(data_now.length-m-1)+yScale.bandwidth()/2}
 						return t;}}});
 					svg.select("#Time").transition().delay(1100*i).duration(800)
 					.text("Year"+" "+Month[i])
 					}
  }

// initialzation

    //svg.select("g").selectAll('rect').transition().delay(300*i).transition(2000).attr("y",function(d,i){return yScale(i);})}
		</script>

	</body>
</html>
